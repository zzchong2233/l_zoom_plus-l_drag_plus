$.fn.extend({
	l_drag: function(flag,scale) {
		if(flag == undefined)
				flag = true;
		if(flag){
			if(scale == undefined){
				scale = 1;
			}else{
				var ratio = 1 / scale;
				scale = ratio;
			}
			this.css({
				"position": "absolute",
				"cursor": "move"
			});
			//注册全局监听事件实现点击空白处时隐藏线框
				$(document).off("mousedown");
			  $(document).on("mousedown", "html", function(){
				$(".drag").addClass("zoom");
			});
			  this.mousedown(function(b) {
				event.stopPropagation();//阻止事件冒泡
				//隐藏其它对象的线框
				$(".drag").addClass("zoom");
				//点击元素显示可拖拽线框
				var id = "#" + $(this)[0].id;
				//显示线框
				$(id + " .drag").removeClass("zoom");
				var a = $(this);
				var b = event || window.event;
				a.start_pos = {
					x: b.clientX,
					y: b.clientY
				};
				a.start_pos_box = {
					x: parseInt(a.css("left")),
					y: parseInt(a.css("top"))
				};
				a.sk = {
					x: a.start_pos_box.x + a.start_pos.x,
					y: a.start_pos_box.y + a.start_pos.y
				};
				window.onmousemove = function(c) {
					var c = event || window.event;
					var left = scale * (c.clientX - a.start_pos.x) + a.start_pos_box.x;
					if(left < 0 )
						left = 0;
					var top =scale * ( c.clientY - a.start_pos.y) + a.start_pos_box.y ;
					if(top <0)
						top = 0;
					a.css({
						left: left,
						top: top
					})
				};
				window.onmouseup = function(c) {
					var c = event || window.event;
					window.onmousemove = null;
				}
			});
			return this
		}else{
			//移除监听事件
			this.css({
				"cursor": "auto"
			});
			$(this).off("mousedown");
			return this
		}
	}
});
